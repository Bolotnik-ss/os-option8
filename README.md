# Система слежения

Данный проект реализует систему слежения, которая делает снимки веб-камеры с заданым интервалом и сохраняет их в формате JPEG в заданную директорию.

## Предварительные требования

Перед установкой необходимо убедиться, что на системе выполнены следующие условия:

- Операционная система Linux, использующая систему инициализации SystemD (Ubuntu, Debian, CentOS и другие). В инструкции приведены команды для дистрибутивов, основанных на Debian.
- Установлены необходимые пакеты:
  - `build-essential` для компиляции исходного кода.
  - `libjpeg-dev` для работы с изображениями в формате JPEG.
  - `v4l-utils` для работы с видеоустройствами.
- Устройство веб-камеры подключено к компьютеру и доступно через `/dev/video0`.

## Установка

Для установки программного обеспечения выполните следующие шаги:

1. Клонируйте репозиторий с исходным кодом:
   ```bash
   git clone https://github.com/Bolotnik-ss/os-option8.git
   cd os-option8/src
   ```

2. Настройте директорию для сохранения снимков и интервал съемки с помощью файла `option8.conf`. В этом файле можно настроить следующие параметры:
   - `save_path` — путь к каталогу, где будут сохраняться снимки. Пример:
     ```plaintext
     save_path = /tmp/snapshots
     ```
   - `interval` — временной интервал между снимками в секундах. Пример:
     ```plaintext
     interval = 30
     ```

   Если конфигурация не задана, будут использоваться значения по умолчанию:
   - `save_path = /tmp/snapshots`
   - `interval = 30`

3. Соберите программу с помощью `make`:
   ```bash
   make
   ```

4. Установите программу в систему:
   ```bash
   sudo make install
   ```

   Это установит исполняемый файл в `/usr/local/bin`, сервисный файл в `/etc/systemd/system` и конфигурационный файл в `/etc`. При этом сервис запустится самостоятельно.

## Конфигурация

После установки драйвера его конфигурация будет храниться в файле `/etc/option8.conf`. Работа с файлом аналогична процессу конфигурации перед установкой драйвера.

## Использование

После установки и настройки программы сервис будет автоматически делать снимки с камеры с интервалом, заданным в конфигурационном файле, и сохранять их в указанной папке. Также сервис будет настроен на автоматический запуск после загрузки системы.

Для управления сервисом используйте следующие команды:

- Остановить сервис:
  ```bash
  sudo systemctl stop option8.service
  ```

- Запустить сервис:
  ```bash
  sudo systemctl start option8.service
  ```

- Перезапустить сервис:
  ```bash
  sudo systemctl restart option8.service
  ```

- Убрать сервис из автозапуска:
  ```bash
  sudo systemctl disable option8.service
  ```

- Добавить сервис в автозапуск:
  ```bash
  sudo systemctl enable option8.service
  ```

- Посмотреть статус сервиса:
  ```bash
  sudo systemctl status option8.service
  ```

Снимки будут сохраняться в каталоге, указанном в конфигурационном файле, с именами в формате:
```plaintext
snapshot_YYYYMMDD_HHMMSS.jpg
```

## Удаление

Для удаления программы удалите сервис и файлы программы:
```bash
sudo make uninstall
```

## Ошибки и их устранение

- Если программа не может открыть видеоустройство `/dev/video0`, убедитесь, что камера подключена и правильно настроена в системе.
- Если программа не запускается или не сохраняет изображения, проверьте журнал ошибок с помощью команды:
  ```bash
  journalctl -u option8.service
  ```
